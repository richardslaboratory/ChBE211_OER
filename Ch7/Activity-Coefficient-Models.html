
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Activity Coefficients &#8212; Introduction to Thermodynamics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Thermodynamics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Multiphysics Problems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Definitions and Balance Expressions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch1/1.Thermodynamic-Definitions.html">
   Thermodynamic Definitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch1/2.Real-Gas-Properties.html">
   Real Gas Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch1/3.Equations-of-State.html">
   Equations of State
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch1/4.Balance-Expressions.html">
   Macroscopic Balance Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch1/5.Conservation-of-Mass.html">
   Conservation of Mass
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Foundations of Thermodynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch2/1.Conservation-of-Energy.html">
   Conservation of Energy and the 1st Law of Thermodynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch2/2.Entropy-Balance-Expression.html">
   Balance Expression for Entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch2/3.Entropy-at-0K.html">
   Entropy at 0K
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch2/4.Free-Energies.html">
   Free Energy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch2/5.Changes-of-State.html">
   Changes of State
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications of Thermodynamics in Chemical Engineering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/1.Unit-Operations.html">
   Unit Operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/2.Property-Diagram-Single-Components.html">
   Property Database for Common Substances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/3.Heat-Engines.html">
   Heat Engines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/4.Refrigeration.html">
   Refrigeration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/5.Liquefaction.html">
   Liquefaction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch3/6.Optimizing-with-Python.html">
   Unit Operations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Vapor-Liquid Equilibrium for Non-Ideal Gases
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/1.Deriving-Useful-Thermodynamic-Relationships.html">
   Deriving Useful Thermodynamic Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/2.Virial-Equations-of-State.html">
   Volumetric Equations of State
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/3.Law-of-Corresponding-States.html">
   Law of Corresponding States and Critical Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/4.Thermal-Variables-from-EOS.html">
   Computing Thermal Variables from an Equation of State
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/5.Calculating-Fugacity.html">
   Calculating Fugacity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch4/6.Vapor-Liquid-Equilibrium.html">
   Vapor Liquid Equilibrium
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thermodynamics of Mixtures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch5/3.Gaseous-Mixtures.html">
   Gaseous Mixtures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch5/4.Liquid-Mixtures.html">
   Liquid Mixtures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch6/5.Chemical-Equilibrium.html">
   Chemical Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Ch6/6.Species-Balance-Expression.html">
   Species Balance Expression and Reaction Kinetics
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Ch7/Activity-Coefficient-Models.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Ch7/Activity-Coefficient-Models.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Activity Coefficients
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#derivation-of-the-activity-coefficient">
   Derivation of the Activity Coefficient:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ideal-mixture">
     The Ideal Mixture
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excess-properties">
     Excess Properties
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activity-coefficient">
     Activity Coefficient
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#physics-based-models-regular-solution-theory">
   Physics Based Models - Regular Solution Theory:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#van-laar-activity-coefficient-expressions">
     van Laar Activity Coefficient Expressions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regular-solutions">
     Regular Solutions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-begin-by-programming-the-equations">
     Let’s begin by programming the equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-plot-the-activity-coefficients-using-the-van-laar-expressions">
       Lets plot the activity coefficients using the van Laar expressions:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emperical-models">
   Emperical Models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redlich-kiester-expension-of-excess-gibbs-energy">
     Redlich-Kiester Expension of excess Gibbs Energy
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#one-constant-margules">
       One constant Margules:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#two-constant-margules">
       Two Constant Margules:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-compare-the-two-constant-margules-expression-to-the-van-laar-equations">
       lets compare the two constant margules expression to the van Laar equations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multi-parameter-correlative-equations">
   Multi-parameter Correlative Equations
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#group-contribution-models">
   Group Contribution Models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-of-unifac-calculation-with-phasepy">
     Example of UNIFAC Calculation with PhasePy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initializing-vdw-equation-of-state">
     Initializing: VDW Equation of State
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peng-robinson-equation-of-state-with-unifac-activity-model">
     Peng-Robinson Equation of State with UNIFAC Activity Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redlich-kwong-soave-eos">
     Redlich Kwong Soave EOS
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Activity Coefficients</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Activity Coefficients
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#derivation-of-the-activity-coefficient">
   Derivation of the Activity Coefficient:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ideal-mixture">
     The Ideal Mixture
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excess-properties">
     Excess Properties
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activity-coefficient">
     Activity Coefficient
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#physics-based-models-regular-solution-theory">
   Physics Based Models - Regular Solution Theory:
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#van-laar-activity-coefficient-expressions">
     van Laar Activity Coefficient Expressions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regular-solutions">
     Regular Solutions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lets-begin-by-programming-the-equations">
     Let’s begin by programming the equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-plot-the-activity-coefficients-using-the-van-laar-expressions">
       Lets plot the activity coefficients using the van Laar expressions:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emperical-models">
   Emperical Models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redlich-kiester-expension-of-excess-gibbs-energy">
     Redlich-Kiester Expension of excess Gibbs Energy
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#one-constant-margules">
       One constant Margules:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#two-constant-margules">
       Two Constant Margules:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-compare-the-two-constant-margules-expression-to-the-van-laar-equations">
       lets compare the two constant margules expression to the van Laar equations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multi-parameter-correlative-equations">
   Multi-parameter Correlative Equations
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#group-contribution-models">
   Group Contribution Models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-of-unifac-calculation-with-phasepy">
     Example of UNIFAC Calculation with PhasePy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initializing-vdw-equation-of-state">
     Initializing: VDW Equation of State
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peng-robinson-equation-of-state-with-unifac-activity-model">
     Peng-Robinson Equation of State with UNIFAC Activity Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redlich-kwong-soave-eos">
     Redlich Kwong Soave EOS
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="activity-coefficients">
<h1>Activity Coefficients<a class="headerlink" href="#activity-coefficients" title="Permalink to this headline">#</a></h1>
<p>This lecture covers two illustrative examples of activity coefficient calculations</p>
<ol class="simple">
<li><p>Derivation of Activity Coefficient</p></li>
<li><p>Physics Based Models - Regular Solution Theory</p></li>
<li><p>Correlation Based Models - UNIFAQ and NRTL</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="derivation-of-the-activity-coefficient">
<h1>Derivation of the Activity Coefficient:<a class="headerlink" href="#derivation-of-the-activity-coefficient" title="Permalink to this headline">#</a></h1>
<section id="the-ideal-mixture">
<h2>The Ideal Mixture<a class="headerlink" href="#the-ideal-mixture" title="Permalink to this headline">#</a></h2>
<p>Going beyond fugacity of species i in a mixture from equation of state requires the definition of a new property, the activity coefficient. It is used in contemporary thermodynamic calculations due to its direct comparison to experimental data. The starting point for the derivation of the <em>activity coefficient</em> is the ideal mixture.</p>
<p>An ideal mixture can be either a gaseous or liquid mixture. It is defined to be a mixture whose excess molar volumes and enthalpies are zero or:</p>
<div class="math notranslate nohighlight">
\[\bar{H}_i=\underline{H}_i\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\bar{V}_i=\underline{V}_i\]</div>
<p>for such a mixture, we can employ the definition for the Gibb’s Free Energy, <span class="math notranslate nohighlight">\(G=H-TS\)</span> to define the Gibb’s Free Energy of an ideal Mixture as:</p>
<div class="math notranslate nohighlight">
\[\underline{G}^{IM}=\sum_i x_i \underline{G}_i+RT\sum_i x_i ln(x_i)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\underline{G}_i=\underline{H}_i-T\underline{S}_i\]</div>
<p>and the second term <span class="math notranslate nohighlight">\(RT\sum_i x_i ln(x_i)\)</span> is the excess entropy of an ideal mixture that treats the mixture as homogeneous in space.</p>
</section>
<section id="excess-properties">
<h2>Excess Properties<a class="headerlink" href="#excess-properties" title="Permalink to this headline">#</a></h2>
<p>Molar excess properties are simply defined as the difference between the partial molar property and the molar property of the species in the equivalent ideal mixture or:</p>
<div class="math notranslate nohighlight">
\[\bar{\theta}_{i}^{ex}=\bar{\theta}_i-\bar{\theta}_i^{IM}\]</div>
<p>The notation here is tricky as for the both the <span class="math notranslate nohighlight">\(\bar{\theta}_i^{IM}=\underline{\theta}_i\)</span> in some cases and not in others.</p>
<p>A summary of the excess partial molar properties are given in the tabel below:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>property</p></th>
<th class="head"><p>Equation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\bar{V}_i^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\bar{V}_i-\underline{V}_i\)</span>$</p></td>
</tr>
<tr class="row-odd"><td><p>$<span class="math notranslate nohighlight">\(\bar{U}_i^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\bar{U}_i-\underline{H}_i\)</span>$</p></td>
</tr>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\bar{H}_i^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\bar{H}_i-\underline{H}_i\)</span>$</p></td>
</tr>
<tr class="row-odd"><td><p>$<span class="math notranslate nohighlight">\(\bar{S}_i^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\bar{S}_i-\underline{S}_i + Rln(x_i)\)</span>$</p></td>
</tr>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\bar{G}_i^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\bar{G}_i-\underline{G}_i - RTln(x_i)\)</span>$</p></td>
</tr>
</tbody>
</table>
<p>This is in contrast to the excess molar property which is given in the table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>property</p></th>
<th class="head"><p>Equation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\underline{V}^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\Delta_{mix}\underline{V}\)</span>$</p></td>
</tr>
<tr class="row-odd"><td><p>$<span class="math notranslate nohighlight">\(\underline{U}^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\Delta_{mix}\underline{U}\)</span>$</p></td>
</tr>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\underline{H}^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\Delta_{mix}\underline{H}\)</span>$</p></td>
</tr>
<tr class="row-odd"><td><p>$<span class="math notranslate nohighlight">\(\underline{S}^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\Delta_{mix}\underline{S} + R\sum_i x_i ln(x_i)\)</span>$</p></td>
</tr>
<tr class="row-even"><td><p>$<span class="math notranslate nohighlight">\(\underline{G}^{ex} \)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\Delta_{mix}\underline{G} - RT\sum_i x_i ln(x_i)\)</span>$</p></td>
</tr>
</tbody>
</table>
</section>
<section id="activity-coefficient">
<h2>Activity Coefficient<a class="headerlink" href="#activity-coefficient" title="Permalink to this headline">#</a></h2>
<p>The activity coefficient is derived from the fugacity of species i in a mixture if we use the partial molar excess Gibbs Free Energy, then we have:</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=\bar{G}_i-\bar{G}_i^{IM}\)</span></p>
<p>by adding and subtracting the partial molar property of the ideal gas mixture (<span class="math notranslate nohighlight">\(\bar{G}_i^{IG}\)</span>), the equation becomes:</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=(\bar{G}_i-\bar{G}_i^{IG})+(\bar{G}_i^{IG}-\bar{G}_i^{IM})\)</span></p>
<p>if we employ the definitions:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\bar{G}_i=\underline{G}_i-RTlnx_i\)</span></p></li>
</ol>
<p>Then the above can be rewritten as</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=(\bar{G}_i-\bar{G}_i^{IG})+(\underline{G}_i^{IG}-\underline{G}_i)\)</span></p>
<p>note the change from partial molar properties to molar properties. The second term in the paranthesis is none other than the departure function for the Gibbs Free energy of species i, which we have shown previously is given as:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}_i^{IG}-\underline{G}_i=RT\ln{\dfrac{f_i}{P}}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(f_i\)</span> is the fugacity of species <span class="math notranslate nohighlight">\(i\)</span> at a given temperature and pressure and <span class="math notranslate nohighlight">\(P\)</span> is the macroscopic pressure of the mixture.</p>
<p>The term on the left we showed in the derivation for equilibrium of a mixture that</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i-\bar{G}_i^{IG}=RT\ln{\dfrac{\bar{f}_i}{x_iP}}\)</span></p>
<p>combining the two, we arrive at the final expression:</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=RT\ln{\dfrac{\bar{f}_i}{x_iP}}-RT\ln{\dfrac{f_i}{P}}\)</span></p>
<p>or using the properties of logs written as:</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=RT\ln{\dfrac{\bar{f}_i}{f_ix_i}}\)</span></p>
<p>if we define the fraction within the logarithm as the activity coefficient of species <span class="math notranslate nohighlight">\(i\)</span> such that:</p>
<p><span class="math notranslate nohighlight">\(\quad \gamma_i=\dfrac{\bar{f}_i}{f_ix_i}\)</span></p>
<p>then, we have</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=RT\ln{\gamma_i}\)</span></p>
<p>which can be measured from simple property data using the table above and calculated using:</p>
<p><span class="math notranslate nohighlight">\(\quad \bar{G}_i^{ex}=\bigg(\dfrac{\partial (N\underline{G}^{ex})}{\partial N_i}\bigg)_{T,P,N_{j\ne i}}\)</span></p>
<p>So to summarize, we can collect some property data including measurements of <span class="math notranslate nohighlight">\(\underline{V}\)</span>, <span class="math notranslate nohighlight">\(\underline{H}\)</span>. Further, if we use the definition that</p>
<p><span class="math notranslate nohighlight">\(\quad \dfrac{\partial}{\partial T}\bigg|_P\bigg(\dfrac{\underline{G}}{T}\bigg)=-\bigg(\dfrac{\underline{H}}{T^2}\bigg)\)</span></p>
<p>to show that:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}^{ex}=T\int -\dfrac{\underline{H}^{ex}}{T^2} dT\)</span></p>
</section>
<section id="summary">
<h2>Summary:<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>Activity Coefficient is defined such that:</p>
<ul class="simple">
<li><p>It represents the deviation from ideal mixing</p></li>
<li><p>It can be calculated from real iquid mixture property data</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar{G}_i^{ex}=RT\ln{\gamma_i}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma_i x_i f_i =\bar{f}_i \)</span></p></li>
</ul>
<p>Therefore, if we can measure the activity coefficient, then equilibrium properties can be calculated from a combination of an accurate equation of state for the pure components and property measurements describing the molar excess Gibb’s Free Energy.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="physics-based-models-regular-solution-theory">
<h1>Physics Based Models - Regular Solution Theory:<a class="headerlink" href="#physics-based-models-regular-solution-theory" title="Permalink to this headline">#</a></h1>
<p>van Laar was the graduate student of Van der Waal who extended Van der Waal’s equation of state to describe the activity of binary mixtures. van Laar employed two assumptions.</p>
<ol class="simple">
<li><p>The binary mixture is composed of fluids of similar sizes and energies</p></li>
<li><p>The fluids within the binary mixtures are both accurately described by the van der Waal equation of state</p></li>
</ol>
<p>The immediate implication of both assumptions above is that the fluids will mix uniformly and the molar excess Gibbs energy will be approximated by:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}^{ex}=\underline{U}^{ex}\)</span></p>
<p>because <span class="math notranslate nohighlight">\(\underline{V}^{ex}\approx 0\)</span> and <span class="math notranslate nohighlight">\(\underline{S}^{ex}\approx0\)</span> based on assumption 1.</p>
<p>Because the internal enery is a state function, we follow a path of convenience for the purpose of this calculation. The path chosen is:</p>
<ol class="simple">
<li><p>Isothermally expand pure liquids 1 and 2 to the ideal gas state</p></li>
<li><p>In the ideal gas state form an ideal gas mixture of the two components.</p></li>
<li><p>Compress the resulting gas mixture at constant temperature to the desired final pressure.</p></li>
</ol>
<p>For each of these steps, we can calculate the change of internal energy using our thermo relations:</p>
<div class="math notranslate nohighlight">
\[\bigg(\dfrac{\partial \underline{U}}{\partial \underline{V}}\bigg)_T=T\bigg(\dfrac{\partial P}{\partial T}\bigg)_\underline{V}-P\]</div>
<p>Applying assumption 2 to this relationship above,where</p>
<div class="math notranslate nohighlight">
\[ P = \dfrac{RT}{\underline{V}-b}-\dfrac{a}{\underline{V}^2}\]</div>
<p>we can see that:</p>
<div class="math notranslate nohighlight">
\[\Delta \underline{U}=\int \bigg(\dfrac{\partial \underline{U}}{\partial \underline{V}}\bigg)_T d\underline{V}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\bigg(\dfrac{\partial \underline{U}}{\partial \underline{V}}\bigg)_T=\dfrac{a}{\underline{V}^2}\]</div>
<p>Using this result for the three step process above, we can develop three equations:</p>
<ol class="simple">
<li><p>We must expand <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> number of moles of species 1 and 2 from the liquid phase to the ideal gas state.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta\underline{U}^I=x_1\int_{\underline{V}_1}^{\infty} \dfrac{a_1}{\underline{V}^2}d\underline{V}+
x_2\int_{\underline{V}_2}^{\infty} \dfrac{a_2}{\underline{V}^2}d\underline{V}=
x_1\dfrac{a_1}{\underline{V}_1}+x_2\dfrac{a_2}{\underline{V}_2}\)</span></p></li>
</ul>
</li>
<li><p>We mix the two ideal gases together,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta\underline{U}^{II}=0\)</span> because it is an ideal gas mixture</p></li>
</ul>
</li>
<li><p>We compress back to the desired density isothermally</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta\underline{U}^{III}=\int_{\infty}^{\underline{V}_{mix}}\dfrac{a_mix}{\underline{V}^2}d\underline{V}=
-\dfrac{a_{mix}}{\underline{V}_{mix}}\)</span></p></li>
</ul>
</li>
</ol>
<p>putting it all together, we find that:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}^{ex}=x_1\dfrac{a_1}{\underline{V}_1}+x_2\dfrac{a_2}{\underline{V}_2}-\dfrac{a_{mix}}{\underline{V}_{mix}}\)</span></p>
<p>if we further take that molar volume of the liquid phase to be about equal to the excluded volume of the liquids <span class="math notranslate nohighlight">\(b\)</span>, then we have:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}^{ex}=x_1\dfrac{a_1}{b_1}+x_2\dfrac{a_2}{b_2}-\dfrac{a_1x_1^2+2k_{ij}x_1x_2+a_2x_2^2}{x_1b_1+x_2b_2}\)</span></p>
<p>setting <span class="math notranslate nohighlight">\(k_{ij}=0\)</span> yields a relatively compact expression:</p>
<p><span class="math notranslate nohighlight">\(\quad \underline{G}^{ex}=\dfrac{x_1x_2b_1b_2}{x_1b_1+x_2b_2}\bigg(\dfrac{\sqrt{a_1}}{b_1}-\dfrac{\sqrt{a_2}}{b_2}\bigg)^2\)</span></p>
<section id="van-laar-activity-coefficient-expressions">
<h2>van Laar Activity Coefficient Expressions.<a class="headerlink" href="#van-laar-activity-coefficient-expressions" title="Permalink to this headline">#</a></h2>
<p>For this binary mixture, it is now possible to compute the activity coefficients which are given as:</p>
<div class="math notranslate nohighlight">
\[RTln{\gamma_1}=\dfrac{\alpha}{\big[1+\frac{\alpha x_1}{\beta x_2}\big]^2}\]</div>
<div class="math notranslate nohighlight">
\[RTln{\gamma_2}=\dfrac{\beta}{\big[1+\frac{\beta x_2}{\alpha x_1}\big]^2}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\alpha=b_1\bigg(\dfrac{\sqrt{a_1}}{b_1}-\dfrac{\sqrt{a_2}}{b_2}\bigg)^2\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\beta=b_2\bigg(\dfrac{\sqrt{a_1}}{b_1}-\dfrac{\sqrt{a_2}}{b_2}\bigg)^2\]</div>
<p>This is the first illustration of a <em>Regular Solution Theory</em> or a theory that describes the activity of a mixture in terms of a small number of coefficients. While the van der Waal’s equation of state has been proven to not be very accurate in describing liquid densities of binary mixtures, this form of the equation has deeper physical intuition about the appropriate functional form of an emperical activity coefficient model.</p>
<p>Let’s Compare the Solution of van Laar and van der Waal’s to real data.</p>
</section>
<section id="regular-solutions">
<h2>Regular Solutions<a class="headerlink" href="#regular-solutions" title="Permalink to this headline">#</a></h2>
<p>Regular Solutions are those where <span class="math notranslate nohighlight">\(\underline{V}^{ex}\)</span> and <span class="math notranslate nohighlight">\(\underline{S}^{ex}\)</span> are zero. While the van Laar is innacurate, it can be vastly improved by fitting experimental data to the numerical values of <span class="math notranslate nohighlight">\(b_1\)</span>, <span class="math notranslate nohighlight">\(b_2\)</span>, <span class="math notranslate nohighlight">\(a_1\)</span>, and <span class="math notranslate nohighlight">\(a_2\)</span> as the function form of the activity coefficient expressions has physical meaning even when the precise numerical parameters are off.</p>
<p>Scatchard extended the van Laar equations by assuming that the activity coefficients had a relatively simple form:</p>
<div class="math notranslate nohighlight">
\[RT\ln{\gamma_1}=b_1\phi_2^2[\delta_1-\delta_2]^2\]</div>
<div class="math notranslate nohighlight">
\[RT\ln{\gamma_2}=b_2\phi_1^2[\delta_1-\delta_2]^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_i\)</span> is the volume fraction of species <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> is the molar volume of species <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(\delta\)</span> is the solubility parameter of species <span class="math notranslate nohighlight">\(i\)</span>.</p>
</section>
<section id="lets-begin-by-programming-the-equations">
<h2>Let’s begin by programming the equations<a class="headerlink" href="#lets-begin-by-programming-the-equations" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">## Binary mixture calculation of van Laar and van der Waal</span>
<span class="n">R</span><span class="o">=</span><span class="mf">8.314</span><span class="c1">##J/mol K</span>

<span class="c1">##species 1 is water</span>
<span class="n">a1</span><span class="o">=</span><span class="mf">0.5542</span><span class="c1">#Pa m^6/mol^2</span>
<span class="n">b1</span><span class="o">=</span><span class="mf">3.051</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span> <span class="c1">##m^3/mol</span>

<span class="c1">##species 2 is ethanol</span>
<span class="n">a2</span><span class="o">=</span><span class="mf">1.218</span><span class="c1">#Pa m^6/mol^2</span>
<span class="n">b2</span><span class="o">=</span><span class="mf">8.407</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span> <span class="c1">##m^3/mol</span>


<span class="c1">#kij</span>
<span class="n">kij</span><span class="o">=</span><span class="mf">0.05</span>

<span class="n">T</span><span class="o">=</span><span class="mi">298</span><span class="c1">##K</span>

<span class="k">def</span> <span class="nf">amix</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">kij</span><span class="p">):</span>
    <span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
    <span class="n">a12</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">kij</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a1</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a12</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">+</span><span class="n">a2</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">bmix</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">):</span>
    <span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
    <span class="k">return</span> <span class="n">b1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">b2</span><span class="o">*</span><span class="n">x2</span>

<span class="k">def</span> <span class="nf">VDW_EOS</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="n">a</span><span class="o">/</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span>
    
<span class="k">def</span> <span class="nf">activity</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">x1</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">b1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span><span class="o">/</span><span class="n">b1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span><span class="o">/</span><span class="n">b2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        
    <span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span><span class="o">/</span><span class="n">b1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span><span class="o">/</span><span class="n">b2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
    <span class="n">a</span><span class="o">=</span><span class="n">alpha</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span>
    <span class="n">b</span><span class="o">=</span><span class="n">beta</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">),</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<section id="lets-plot-the-activity-coefficients-using-the-van-laar-expressions">
<h3>Lets plot the activity coefficients using the van Laar expressions:<a class="headerlink" href="#lets-plot-the-activity-coefficients-using-the-van-laar-expressions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">.99</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">g1</span><span class="p">,</span><span class="n">g2</span><span class="o">=</span><span class="n">activity</span><span class="p">(</span><span class="mi">298</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">g1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$i=1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">g2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$i=2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$ln(\gamma_i)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x21ac2701c70&gt;
</pre></div>
</div>
<img alt="../_images/Activity-Coefficient-Models_7_1.png" src="../_images/Activity-Coefficient-Models_7_1.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="emperical-models">
<h1>Emperical Models<a class="headerlink" href="#emperical-models" title="Permalink to this headline">#</a></h1>
<section id="redlich-kiester-expension-of-excess-gibbs-energy">
<h2>Redlich-Kiester Expension of excess Gibbs Energy<a class="headerlink" href="#redlich-kiester-expension-of-excess-gibbs-energy" title="Permalink to this headline">#</a></h2>
<div class="math notranslate nohighlight">
\[\underline{G}^{ex}=x_1x_2(A+B(x_1-x_2)+C(x_1-x_2)^2+\ldots)\]</div>
<section id="one-constant-margules">
<h3>One constant Margules:<a class="headerlink" href="#one-constant-margules" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\underline{G}^{ex}=Ax_1x_2\)</span></p>
<p><span class="math notranslate nohighlight">\(RT\ln{\gamma_1}=Ax_2^2\)</span></p>
<p><span class="math notranslate nohighlight">\(RT\ln{\gamma_2}=Ax_1^2\)</span></p>
<p>Note that when the van Laar constants <span class="math notranslate nohighlight">\(\alpha\approx\beta\)</span>, the one constant margules expression is equivalent to the van Laar equations.</p>
</section>
<section id="two-constant-margules">
<h3>Two Constant Margules:<a class="headerlink" href="#two-constant-margules" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\underline{G}^{ex}=x_1x_2(A+B(x_1-x_2))\)</span></p>
<p><span class="math notranslate nohighlight">\(RT\ln{\gamma_1}=\alpha_1x_2^2+\beta_1x_2^3\)</span></p>
<p><span class="math notranslate nohighlight">\(RT\ln{\gamma_2}=\alpha_2x_1^2+\beta_2x_1^3\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\alpha_i=A+3(-1)^{i+1}B\)</span> and <span class="math notranslate nohighlight">\(\beta_i=4(-1)^{i}B\)</span></p>
</section>
<section id="lets-compare-the-two-constant-margules-expression-to-the-van-laar-equations">
<h3>lets compare the two constant margules expression to the van Laar equations<a class="headerlink" href="#lets-compare-the-two-constant-margules-expression-to-the-van-laar-equations" title="Permalink to this headline">#</a></h3>
<p>We can do so by plotting <span class="math notranslate nohighlight">\(\dfrac{\underline{G}^{ex}}{x_1x_2} vs. (x_1-x_2)\)</span> for the van Laar equations and determining how many terms are necessary to fit the experimental data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="k">def</span> <span class="nf">G_ex</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">x1</span><span class="p">):</span>
    <span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
    <span class="k">return</span> <span class="n">x1</span><span class="o">*</span><span class="n">a1</span><span class="o">/</span><span class="n">b1</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">a2</span><span class="o">/</span><span class="n">b2</span><span class="o">-</span><span class="n">amix</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">kij</span><span class="p">)</span><span class="o">/</span><span class="n">bmix</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span>


<span class="n">T</span><span class="o">=</span><span class="mi">298</span><span class="c1">##K</span>
<span class="n">P</span><span class="o">=</span><span class="mf">1.05</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span>
<span class="n">Gex</span><span class="o">=</span><span class="n">G_ex</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
    <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">,</span><span class="n">Gex</span><span class="p">,</span><span class="n">deg</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">Gex_mod</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">Gex_mod</span><span class="o">+=</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="n">n</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">,</span><span class="n">Gex_mod</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">,</span><span class="n">Gex</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;van Laar&#39;</span><span class="p">)</span>

<span class="c1">#plt.plot(x1-x2,g2,label=r&#39;$i=2$&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\underbar</span><span class="si">{G}</span><span class="s1">^</span><span class="si">{ex}</span><span class="s1">/RT$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1-x_2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>



    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x21ac3049a30&gt;
</pre></div>
</div>
<img alt="../_images/Activity-Coefficient-Models_10_1.png" src="../_images/Activity-Coefficient-Models_10_1.png" />
</div>
</div>
<p>We can see that the Margules expression requires 4 constants to provide an accurate description of the compositional dependence of the excess molar Gibbs energy. This is compared with the 5 constants for the van Laar equation. While this seems to suggest that the Margules expression is superior, we can imagine needing to describe the temperature and pressure dependence of the constants in the Margules expressions would require vast quantities of emperical data. Where the 4 constants contained within the van der Waals equation of state remain unchanged. This is one of the core strengths of thermodynamic theory - the ability to predict quantitatively behavior from a minimal set of tabulated thermodynamic information.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="multi-parameter-correlative-equations">
<h1>Multi-parameter Correlative Equations<a class="headerlink" href="#multi-parameter-correlative-equations" title="Permalink to this headline">#</a></h1>
<p>We have seen up to this point a variety of approaches for predicting activity coefficients based on a minimal set of thermodynamic information that describes not only a single species but also its behavior in a mixture. You are probably now also appreciating that calculations of this type both require large amounts of experimental data for accuracy but also are computationally intensive as the number of parameters and components within the mixture increases.</p>
<p>Using statistical thermodynamics, a microscopic approach permits the construction of physical models that can be used to more accurately predict activity coefficients of binary mixtures. These models can be extended to more complicated mixtures, but this is outside the scope of this class. The equations are given for the readers interest.</p>
<ul class="simple">
<li><p>Wilson Equation (1964)</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\quad\quad \underline{G}^{ex}=-RT\sum_i x_i ln(x_i +x_j\Lambda_{ij})\)</span> where <span class="math notranslate nohighlight">\(\Lambda_{ij}=\dfrac{b_j}{b_i}exp(-(\lambda_{ij}-\lambda_{ii})/RT)\)</span></p>
<p>In the Wilson equation, <span class="math notranslate nohighlight">\(\underline{U}^{ex}=\lambda_{ij}-\lambda_{ii}\)</span> describes the difference in interaction strength of a molecule with itself and a molecule with a <span class="math notranslate nohighlight">\(j^{th}\)</span> component within the mixture. With the excess Gibbs Energy, it is straightforward to derive an expression for the activity coefficients</p>
<ul class="simple">
<li><p>NRTL Equation</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\quad\quad \underline{G}^{ex}=RTx_1x_2\bigg(\dfrac{\tau_{21}G_{21}}{(x_1+x_2G_{21})^2}+\dfrac{\tau_{12}G_{12}}{(x_2+x_1 G_{12})^{2}}\bigg)\)</span> where <span class="math notranslate nohighlight">\(lnG_{ij}=-\alpha\tau_{ij}\)</span></p>
<p>The NRTL and Wilson Equations are extensions of the van Laar equations such that they allow for differences in the interaction energy and volumes of the species within the mixture. Generalized to greater than one component in the mixtures, these models generally do a poor job of quantitative prediction.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="group-contribution-models">
<h1>Group Contribution Models<a class="headerlink" href="#group-contribution-models" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>UNIFAC (UNIquac Functional-group Activity Coefficients)</p></li>
<li><p>UNIQAC (UNIversal Qasichemical Activity Coefficients)</p></li>
</ul>
<p>The main difference between UNIFAC and UNIQAC models is that the molar volumes and areas of a molecule are included in considering the site-site interaction between molecules in a mixture. These properties are calculated form so-called “group-contribution” models which estimate the volume contribution and area contribution of different sub-units of a molecule. These group contributions are relatively easily tabulated and their parameters calculated based on fitting large quantities of experimental data sets. While limited calculations are best done by hand, the computations are easily done computationally.</p>
<p>A convenient python based package implements UNIFAC for equilibrium calculations. An example of this is below:</p>
<section id="example-of-unifac-calculation-with-phasepy">
<h2>Example of UNIFAC Calculation with PhasePy<a class="headerlink" href="#example-of-unifac-calculation-with-phasepy" title="Permalink to this headline">#</a></h2>
<p>Example adapted from <a class="reference external" href="https://github.com/gustavochm/phasepy/blob/1466977c148974729bdd60cda28515bd844f5fb9/examples/1.%20Components%20and%20mixtures.ipynb">phasepy documentation</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">phasepy</span> <span class="kn">import</span> <span class="n">component</span><span class="p">,</span> <span class="n">mixture</span><span class="p">,</span> <span class="n">preos</span><span class="p">,</span> <span class="n">vdweos</span><span class="p">,</span> <span class="n">rkseos</span><span class="p">,</span><span class="n">virialgamma</span>

<span class="n">water</span> <span class="o">=</span> <span class="n">component</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="n">Tc</span><span class="o">=</span><span class="mf">647.13</span><span class="p">,</span> <span class="n">Pc</span><span class="o">=</span><span class="mf">220.55</span><span class="p">,</span> <span class="n">Zc</span><span class="o">=</span><span class="mf">0.229</span><span class="p">,</span> <span class="n">Vc</span><span class="o">=</span><span class="mf">55.948</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.344861</span><span class="p">,</span>
                  <span class="n">GC</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">ri</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span> <span class="n">qi</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">Mw</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="n">component</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ethanol&#39;</span><span class="p">,</span><span class="n">Tc</span><span class="o">=</span><span class="mi">514</span><span class="p">,</span> <span class="n">Pc</span><span class="o">=</span><span class="mf">61.37</span><span class="p">,</span> <span class="n">Zc</span><span class="o">=</span><span class="mf">0.241</span><span class="p">,</span> <span class="n">Vc</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.643558</span><span class="p">,</span> 
                    <span class="n">GC</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CH3&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;CH2&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;OH(P)&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="n">ri</span><span class="o">=</span><span class="mf">2.1055</span><span class="p">,</span> <span class="n">qi</span><span class="o">=</span><span class="mf">1.972</span><span class="p">,</span> <span class="n">Mw</span><span class="o">=</span><span class="mf">46.07</span><span class="p">)</span>

<span class="n">mix</span> <span class="o">=</span> <span class="n">mixture</span><span class="p">(</span><span class="n">water</span><span class="p">,</span><span class="n">ethanol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initializing-vdw-equation-of-state">
<h2>Initializing: VDW Equation of State<a class="headerlink" href="#initializing-vdw-equation-of-state" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Kij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.11</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">mix</span><span class="o">.</span><span class="n">kij_cubic</span><span class="p">(</span><span class="n">Kij</span><span class="p">)</span>

<span class="n">eos1</span> <span class="o">=</span> <span class="n">vdweos</span><span class="p">(</span><span class="n">mix</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">virialgamma</span><span class="p">(</span><span class="n">mix</span><span class="p">,</span><span class="n">actmodel</span><span class="o">=</span><span class="s1">&#39;uniquac&#39;</span><span class="p">)</span>
eos1<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="peng-robinson-equation-of-state-with-unifac-activity-model">
<h2>Peng-Robinson Equation of State with UNIFAC Activity Model<a class="headerlink" href="#peng-robinson-equation-of-state-with-unifac-activity-model" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span><span class="o">.</span><span class="n">unifac</span><span class="p">()</span>
<span class="n">eos2</span> <span class="o">=</span> <span class="n">preos</span><span class="p">(</span><span class="n">mix</span><span class="p">,</span> <span class="n">mixrule</span><span class="o">=</span><span class="s1">&#39;qmr&#39;</span><span class="p">,</span><span class="n">volume_translation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">model2</span> <span class="o">=</span> <span class="n">virialgamma</span><span class="p">(</span><span class="n">mix</span><span class="p">,</span><span class="n">actmodel</span><span class="o">=</span><span class="s1">&#39;unifac&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="redlich-kwong-soave-eos">
<h2>Redlich Kwong Soave EOS<a class="headerlink" href="#redlich-kwong-soave-eos" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># interactions energies in K</span>
<span class="n">A21</span><span class="p">,</span> <span class="n">A12</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.33540823</span><span class="p">,</span> <span class="mf">151.83100234</span> 
<span class="n">Aij0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">A12</span><span class="p">],</span> <span class="p">[</span><span class="n">A21</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">mix</span><span class="o">.</span><span class="n">uniquac</span><span class="p">(</span><span class="n">Aij0</span><span class="p">)</span>

<span class="n">eos3</span> <span class="o">=</span> <span class="n">rkseos</span><span class="p">(</span><span class="n">mix</span><span class="p">,</span> <span class="n">mixrule</span><span class="o">=</span><span class="s1">&#39;qmr&#39;</span><span class="p">,</span><span class="n">volume_translation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model3</span> <span class="o">=</span> <span class="n">virialgamma</span><span class="p">(</span><span class="n">mix</span><span class="p">,</span><span class="n">actmodel</span><span class="o">=</span><span class="s1">&#39;uniquac&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The density of the fluid is computed with the eos.density method. It requires the composition, temperature, pressure and the aggregation state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##emperical data at room temperature conditions</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">298</span>  <span class="c1"># K</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># bar&#39;</span>
<span class="n">w2_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">.05</span><span class="p">)</span>
<span class="n">rho_</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9982</span><span class="p">,</span><span class="mf">0.9894</span><span class="p">,</span><span class="mf">0.9819</span><span class="p">,</span><span class="mf">0.9751</span><span class="p">,</span><span class="mf">0.9686</span><span class="p">,</span>
      <span class="mf">0.9617</span><span class="p">,</span><span class="mf">0.9538</span><span class="p">,</span><span class="mf">0.9449</span><span class="p">,</span><span class="mf">0.9352</span><span class="p">,</span><span class="mf">0.9247</span><span class="p">,</span>
      <span class="mf">0.9138</span><span class="p">,</span><span class="mf">0.9026</span><span class="p">,</span><span class="mf">0.8911</span><span class="p">,</span><span class="mf">0.8795</span><span class="p">,</span><span class="mf">0.8677</span><span class="p">,</span>
      <span class="mf">0.8556</span><span class="p">,</span><span class="mf">0.8434</span><span class="p">,</span><span class="mf">0.8310</span><span class="p">,</span><span class="mf">0.8180</span><span class="p">,</span><span class="mf">0.8042</span><span class="p">,</span><span class="mf">0.7893</span><span class="p">]</span><span class="c1">##kg/m^3</span>

<span class="n">MW1</span><span class="o">=</span><span class="mi">18</span><span class="c1">#g/mol</span>
<span class="n">MW2</span><span class="o">=</span><span class="mf">46.07</span><span class="c1">#g/mol</span>

<span class="n">x1_</span><span class="o">=</span><span class="p">[]</span>
<span class="c1">##let&#39;s check the density calculated from UNIFAC Model</span>
<span class="n">rho_model1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">rho_model2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">rho_model3</span><span class="o">=</span><span class="p">[]</span>
<span class="n">fugmix_model1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">fugmix_model2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">fugmix_model3</span><span class="o">=</span><span class="p">[]</span>

<span class="n">act_model1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">act_model2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">act_model3</span><span class="o">=</span><span class="p">[]</span>


<span class="k">for</span> <span class="n">w2</span> <span class="ow">in</span> <span class="n">w2_</span><span class="p">:</span>
    
    <span class="n">w1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">w2</span>
    <span class="n">x1</span><span class="o">=</span><span class="n">w1</span><span class="o">/</span><span class="n">MW1</span><span class="o">/</span><span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="n">MW1</span><span class="o">+</span><span class="n">w2</span><span class="o">/</span><span class="n">MW2</span><span class="p">)</span>
    <span class="n">x2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
    
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span>
    <span class="n">x1_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    
    <span class="n">MWmix</span><span class="o">=</span><span class="n">MW1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">MW2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">rho_model1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MWmix</span><span class="o">*</span><span class="n">eos1</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">))</span>
    <span class="n">rho_model2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MWmix</span><span class="o">*</span><span class="n">eos2</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">))</span>
    <span class="n">rho_model3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MWmix</span><span class="o">*</span><span class="n">eos3</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">))</span>
    
    <span class="n">fugmix_model1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eos1</span><span class="o">.</span><span class="n">logfugef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fugmix_model2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eos2</span><span class="o">.</span><span class="n">logfugef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fugmix_model3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eos3</span><span class="o">.</span><span class="n">logfugef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">act_model2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">lngama</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    <span class="n">act_model3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model3</span><span class="o">.</span><span class="n">lngama</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">rho_</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">rho_model1</span><span class="p">,</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VDW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">rho_model2</span><span class="p">,</span><span class="s1">&#39;--r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;PREOS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">rho_model3</span><span class="p">,</span><span class="s1">&#39;--b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;RKSEOS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho$ $(kg/m^3)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$ &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="../_images/Activity-Coefficient-Models_23_1.png" src="../_images/Activity-Coefficient-Models_23_1.png" />
</div>
</div>
<p>The pressure of the fluid mixture can be computed at given composition, molar volume and temperature using the eos.pressure method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">act_model2</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;-r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">act_model2</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">act_model3</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">act_model2</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;--b&#39;</span><span class="p">)</span>
<span class="c1">#plt.plot(x1_,np.exp(np.transpose(fugmix_model3)[1]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\ln{\gamma_1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Activity-Coefficient-Models_25_0.png" src="../_images/Activity-Coefficient-Models_25_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Ch7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By J. J. Richards<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>