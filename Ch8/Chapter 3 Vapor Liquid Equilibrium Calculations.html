
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Vapor-Liquid Equilibrium &#8212; Introduction to Thermodynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ch8/Chapter 3 Vapor Liquid Equilibrium Calculations';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Thermodynamics - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Thermodynamics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Foreword
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Definitions and Balance Expressions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ch1/1.Thermodynamic-Definitions.html">Thermodynamic Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch1/2.Real-Gas-Properties.html">Real Gas Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch1/3.Equations-of-State.html">Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch1/4.Balance-Expressions.html">Macroscopic Balance Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch1/5.Conservation-of-Mass.html">Conservation of Mass</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Foundations of Thermodynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ch2/1.Conservation-of-Energy.html">Conservation of Energy and the 1st Law of Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch2/2.Expansion-of-a-Gas.html">Expansion of a Gas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch2/3.Entropy-Balance-Expression.html">Balance Expression for Entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch2/4.Entropy-at-0K.html">Entropy at 0K</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch2/5.Free-Energies.html">Free Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch2/6.Changes-of-State.html">Changes of State</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Applications of Thermodynamics in Chemical Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ch3/1.Unit-Operations.html">Unit Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch3/2.Property-Diagram-Single-Components.html">Property Database for Common Substances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch3/3.Heat-Engines.html">Heat Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch3/4.Refrigeration.html">Refrigeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch3/5.Liquefaction.html">Liquefaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch3/6.Optimizing-with-Python.html">Optimizing with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vapor-Liquid Equilibrium for Non-Ideal Gases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ch4/1.Deriving-Useful-Thermodynamic-Relationships.html">Deriving Useful Thermodynamic Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch4/2.Virial-Equations-of-State.html">Volumetric Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch4/3.Law-of-Corresponding-States.html">Law of Corresponding States and Critical Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch4/4.Thermal-Variables-from-EOS.html">Computing Thermal Variables from an Equation of State</a></li>

<li class="toctree-l1"><a class="reference internal" href="../Ch4/7.Constructing-Property-Diagrams.html">Constructing Property Diagrams</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermodynamics of Mixtures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ch5/1.Introduction-to-Mixtures.html">Introduction to Mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch5/3.Gaseous-Mixtures.html">Gaseous Mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch5/4.Liquid-Mixtures.html">Liquid Mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch5/5.Accuracy-EOS.html">Calculating the Accuracy of Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch7/7.Activity-Coefficient-Models.html">Activity Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch7/8.Calculating-Mixture-Fugacity.html">Vapor-Liquid Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ch7/9.Mixture-Equilibrium.html">Equilibrium of Mixtures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Exercises/Ch1.html">Exercises for Chapter 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exercises/Ch2.html">Exercises for Chapter 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exercises/Ch3.html">Exercises for Chapter 3</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Ch8/Chapter 3 Vapor Liquid Equilibrium Calculations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Vapor-Liquid Equilibrium</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-to-something-workable">Getting To Something Workable:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-do-an-example">Let’s Do an Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-x-y-and-p-x-y-charts-for-acetonitrile-and-1-butanol-at-t-333-15-k-assume-the-mixture-is-ideal">Create x,y and P-x,y charts for acetonitrile and 1-butanol at T = 333.15 K. Assume the mixture is ideal.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-vapor-pressures">Solving for Vapor Pressures</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-phase-mole-fractions">Calculating Phase Mole Fractions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-remaining-variables-p-y-a-y-b">Solving For the Remaining Variables (P, <span class="math notranslate nohighlight">\(y_A\)</span>, <span class="math notranslate nohighlight">\(y_B\)</span>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-all-the-information-we-need-to-generate-x-y-and-p-x-y-charts">We have all the information we need to generate x,y and P-x,y charts!</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-also-generate-a-t-xy-plot">Let’s also generate a T-xy plot.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-define-a-function-that-will-help-us-solve-for-temperature-we-want-to-find-the-temperature-that-makes-the-xa-psata-xb-psatb-p-or-that-makes-p-xa-psata-xb-psatb-0">Let’s define a function that will help us solve for temperature. We want to find the temperature that makes the xA*PsatA + xB*PsatB = P, or that makes P - (xA*PsatA + xB*PsatB) = 0.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-need-to-define-an-initial-guess-array-we-dont-know-what-the-temperature-might-be-so-we-might-make-a-guess-that-the-temperature-is-between-300-and-500c-we-choose-1000-increments-between-300-and-500-to-be-evaluated">We need to define an initial guess array. We don’t know what the temperature might be, so we might make a guess that the temperature is between 300 and 500C. We choose 1000 increments between 300 and 500 to be evaluated</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-1000-increments-is-arbitrary-one-can-choose-any-positive-integer">Note: 1000 increments is arbitrary. One can choose any positive integer!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-solve-for-our-temperatures">Let’s solve for our temperatures!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-our-liquid-molar-fractions-and-temperatures-we-still-need-to-calculate-our-y1-and-y2-values-with-our-true-temperature">We have our liquid molar fractions and temperatures. We still need to calculate our y1 and y2 values with our “true” temperature.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-use-the-antoine-equation-and-raoults-law">We can use the Antoine Equation and Raoult’s Law!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-lets-plot">Now, let’s plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bubble-point">Bubble Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-calculate-the-bubble-point-temperature-if-we-werent-given-a-plot">Let’s calculate the bubble point temperature if we weren’t given a plot.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-first-re-establish-our-variables-we-are-resuing-ones-from-the-example-problems-above">Let’s first (re)establish our variables. We are resuing ones from the example problems above.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-need-to-iterate-over-temperature-to-find-the-temperature-that-makes-the-sum-of-the-vapor-phase-mole-fractions-equal-to-one">We need to iterate over temperature to find the temperature that makes the sum of the vapor phase mole fractions equal to one</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dew-point">Dew Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-calculate-the-dew-point-temperature-if-we-werent-given-a-plot">Let’s calculate the dew point temperature if we weren’t given a plot.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-a-very-similar-problem-to-above-but-now-we-want-to-solve-for-x-a-x-b-1-since-we-know-our-vapor-mole-fractions">We have a very similar problem to above, but now we want to solve for <span class="math notranslate nohighlight">\(x_A + x_B = 1\)</span> since we know our vapor mole fractions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-ideality-is-more-often-the-reality">Non-ideality is More Often the Reality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example">An Example:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="vapor-liquid-equilibrium">
<h1>Vapor-Liquid Equilibrium<a class="headerlink" href="#vapor-liquid-equilibrium" title="Link to this heading">#</a></h1>
<p>As we saw in Chapter 2, fugacity is a core concept for equilibrium relationships. We established:</p>
<div class="math notranslate nohighlight">
\[\overline{f}_i^L(T,P,\underline{x}) = \overline{f}_i^V(T,P,\underline{y}) \]</div>
<p>This is the core equilibrium relationship we will work with for VLE. The liquid and vapor phase fugacities of any component in a mixture will be the same when the system is at equilibrium (T and P will also be the same).</p>
<p>However, we rarely know fugacities in mixtures, so we will again lean on relationships between fugacities and activity coefficients.</p>
<div class="math notranslate nohighlight">
\[\overline{f}_i^L(T,P,\underline{x}) = x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T)\phi_i^{L,vap}(T,P) = \overline{f}_i^V(T,P,\underline{y}) = y_iP\overline{\phi}_i^V(T,P,\underline{y}) \]</div>
<p>This is called the <span style="color:#DA7407"><span class="math notranslate nohighlight">\(\gamma\)</span>-<span class="math notranslate nohighlight">\(\phi\)</span> approach.</span> It has shortcomings:</p>
<ul class="simple">
<li><p>We use an EOS for vapor phase and an activity coefficient and model for the liqquid phase. These are different approaches. The properties of the two phases can never be identical. We will not have fully accurate represention near the vapor-liquid critical region.</p></li>
<li><p>Other methods that use only activity coefficients and EOS would do a better job, but we will not explore them in this course.</p></li>
</ul>
<p>The best approximation for pure liquid fugacity is Equation 7.4-21:</p>
<div class="math notranslate nohighlight">
\[f^L = P^{vap}(T)\left ( \frac{f}{P} \right )_{sat,T} exp \left [ \frac{\underline{V}(P-P^{vap})}{RT} \right ] \]</div>
<p>If P is close to vapor pressure, then the exponential term drops (Poynting correction).</p>
<section id="getting-to-something-workable">
<h2>Getting To Something Workable:<a class="headerlink" href="#getting-to-something-workable" title="Link to this heading">#</a></h2>
<div class="math notranslate nohighlight">
\[\overline{f}_i^L(T,P,\underline{x}) = x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T)\phi_i^{L,vap}(T,P) = \overline{f}_i^V(T,P,\underline{y}) = y_iP\overline{\phi}_i^V(T,P,\underline{y}) \]</div>
<p>Recall the <span style="color:#DA7407"><strong>The Lewis-Randall Rule</strong></span>:</p>
<div class="math notranslate nohighlight">
\[\overline{f}_i^V(T,P,\underline{y}) = y_if_i^V(T,P)\]</div>
<p>We need to know the pure component vapor phase fugacity and vapor phase mole fraction.</p>
<p><span style="color:#DA7407"><strong>VLE at Low Pressures:</strong></span></p>
<div class="math notranslate nohighlight">
\[x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T) \left(\frac{f}{P} \right)_{sat,i} = y_iP\left(\frac{f}{P}\right)_i \]</div>
<p>Summing over all components:</p>
<div class="math notranslate nohighlight">
\[\sum{x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T) \left(\frac{f}{P} \right)_{sat,i}} = P\sum{y_i\left(\frac{f}{P}\right)_i} \]</div>
<p>At low pressures, the gas phase is close to being ideal, so we can assume <span class="math notranslate nohighlight">\(\left ( \frac{f}{P} \right)_i = 1\)</span>. Our equation now becomes:</p>
<div class="math notranslate nohighlight">
\[\sum{x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T) \left(\frac{f}{P} \right)_{sat,i}} = P \]</div>
<p>And if the liquid phase is an ideal mixture, <span class="math notranslate nohighlight">\(\gamma_i = 1\)</span> and <span class="math notranslate nohighlight">\(\frac{f}{P} = 1\)</span>, we get <span style="color:#DA7407"><strong>Raoult’s Law (for ideal liquid and vapor phases):</strong></span></p>
<div class="math notranslate nohighlight">
\[x_iP_i^{vap}(T) = y_iP = P_i\]</div>
<div class="math notranslate nohighlight">
\[\sum{x_iP_i^{vap}(T)} = \sum{P_i} = P \]</div>
<p>How can we find <span class="math notranslate nohighlight">\(P^{vap}\)</span> if we are not given it directly:</p>
<p>Use <span style="color:#DA7407"><strong>Antoine Equation:</strong></span></p>
<div class="math notranslate nohighlight">
\[log\left(P^{vap}(T)\right) = A - \frac{B}{T+C} \]</div>
<p>The NIST Chem WebBook has <span class="math notranslate nohighlight">\(A,B,C\)</span> parameters for many chemicals.</p>
<section id="lets-do-an-example">
<h3>Let’s Do an Example<a class="headerlink" href="#lets-do-an-example" title="Link to this heading">#</a></h3>
<section id="create-x-y-and-p-x-y-charts-for-acetonitrile-and-1-butanol-at-t-333-15-k-assume-the-mixture-is-ideal">
<h4>Create x,y and P-x,y charts for acetonitrile and 1-butanol at T = 333.15 K. Assume the mixture is ideal.<a class="headerlink" href="#create-x-y-and-p-x-y-charts-for-acetonitrile-and-1-butanol-at-t-333-15-k-assume-the-mixture-is-ideal" title="Link to this heading">#</a></h4>
<p>Recalling <span style="color:#DA7407"><strong>Raoult’s Law (for ideal liquid and vapor phases):</strong></span></p>
<div class="math notranslate nohighlight">
\[x_iP_i^{vap}(T) = y_iP = P_i\]</div>
<div class="math notranslate nohighlight">
\[\sum{x_iP_i^{vap}(T)} = \sum{P_i} = P \]</div>
<p>The top equation becomes two equations, one for each component:</p>
<div class="math notranslate nohighlight">
\[x_AP_A^{vap}(T) = y_AP = P_A\]</div>
<div class="math notranslate nohighlight">
\[x_BP_B^{vap}(T) = y_BP = P_B\]</div>
<p>We can write the bottom equation for a binary mixture. Call acetonitrile “A” and 1-butanol “B”:</p>
<div class="math notranslate nohighlight">
\[x_AP_A^{vap}(T) + x_BP_B^{vap}(T) = P\]</div>
<p>And recall our mole balance equations:</p>
<div class="math notranslate nohighlight">
\[x_A + x_B = 1\]</div>
<div class="math notranslate nohighlight">
\[y_A + y_B = 1\]</div>
</section>
<section id="solving-for-vapor-pressures">
<h4>Solving for Vapor Pressures<a class="headerlink" href="#solving-for-vapor-pressures" title="Link to this heading">#</a></h4>
<p>Now, let’s look up the Antoine parameteres from NIST Chem WebBook. P is in bar and T is in K. We plug our values into the Antoine equation and solve for pressure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">333.15</span> <span class="c1"># K</span>

<span class="c1">##Antoine Coefficients</span>
<span class="c1">#Acetonitrile</span>
<span class="n">A_ace</span> <span class="o">=</span> <span class="mf">4.27873</span>
<span class="n">B_ace</span> <span class="o">=</span> <span class="mf">1355.374</span>
<span class="n">C_ace</span> <span class="o">=</span> <span class="o">-</span><span class="mf">37.853</span>
<span class="c1">#1-Butanol</span>
<span class="n">A_but</span> <span class="o">=</span> <span class="mf">4.54607</span>
<span class="n">B_but</span> <span class="o">=</span> <span class="mf">1351.55</span>
<span class="n">C_but</span> <span class="o">=</span> <span class="o">-</span><span class="mf">93.34</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">## Calculating vapor pressure using Antoine Equation</span>

<span class="n">Psat_ace</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_ace</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_ace</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_ace</span><span class="p">)))</span>
<span class="n">Psat_but</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_but</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_but</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_but</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Acetonitrile pressure:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Psat_ace</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1-Butanol pressure:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Psat_but</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Acetonitrile pressure: 0.488 bar
1-Butanol pressure: 0.081 bar
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-phase-mole-fractions">
<h4>Calculating Phase Mole Fractions<a class="headerlink" href="#calculating-phase-mole-fractions" title="Link to this heading">#</a></h4>
<p>First let’s establish which variable we will iterate over. If we set the value of one variable, we can solve for all the others.
Let’s set up an array of <span class="math notranslate nohighlight">\(x_A\)</span> values, ranging from 0 to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span> <span class="c1">## here we choose 10 points to do our calculation at</span>

<span class="c1">## We know xB too, since xA + xB = 1</span>

<span class="n">xB</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xA</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-for-the-remaining-variables-p-y-a-y-b">
<h4>Solving For the Remaining Variables (P, <span class="math notranslate nohighlight">\(y_A\)</span>, <span class="math notranslate nohighlight">\(y_B\)</span>)<a class="headerlink" href="#solving-for-the-remaining-variables-p-y-a-y-b" title="Link to this heading">#</a></h4>
<p>Since we have arrays of <span class="math notranslate nohighlight">\(x_A\)</span> and <span class="math notranslate nohighlight">\(x_B\)</span>, we can now solve for <span class="math notranslate nohighlight">\(P\)</span> and subsequently our vapor mole fractions (<span class="math notranslate nohighlight">\(y_A\)</span> and <span class="math notranslate nohighlight">\(y_B\)</span>)</p>
<div class="math notranslate nohighlight">
\[x_AP_A^{vap}(T) + x_BP_B^{vap}(T) = P\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Solving for overall system pressure, P</span>

<span class="c1">## We need to go through all of our xA (and xB) values to solve for P at each value</span>

<span class="n">P</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## making an empty pressure array to store the values</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xA</span><span class="p">)):</span> <span class="c1">## iterating over the length of xA, which is 10</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="n">xA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Psat_ace</span> <span class="o">+</span> <span class="n">xB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Psat_but</span>
    <span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now for the vapor mole fractions:</p>
<div class="math notranslate nohighlight">
\[x_AP_A^{vap}(T) = y_AP = P_A\]</div>
<div class="math notranslate nohighlight">
\[x_BP_B^{vap}(T) = y_BP = P_B\]</div>
<p>Rearranging for <span class="math notranslate nohighlight">\(y_A\)</span> and <span class="math notranslate nohighlight">\(y_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[y_A = \frac{x_AP_A^{vap}(T)}{P}\]</div>
<div class="math notranslate nohighlight">
\[y_B = \frac{x_BP_B^{vap}(T)}{P}\]</div>
<p><em>Note, we can also calculate <span class="math notranslate nohighlight">\(y_B\)</span> with 1 - <span class="math notranslate nohighlight">\(y_A\)</span></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Let&#39;s solve</span>

<span class="n">yA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">yB</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## making blank arrays to store our vapor mole fraction values</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xA</span><span class="p">)):</span> <span class="c1">## again, iterating over the length of xA. xB and P have the same lengths</span>
    <span class="n">yA_calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Psat_ace</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">yB_calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Psat_but</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">yA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yA_calc</span><span class="p">)</span>
    <span class="n">yB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yB_calc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="we-have-all-the-information-we-need-to-generate-x-y-and-p-x-y-charts">
<h4>We have all the information we need to generate x,y and P-x,y charts!<a class="headerlink" href="#we-have-all-the-information-we-need-to-generate-x-y-and-p-x-y-charts" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## We can plot</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">## First, xy plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xA</span><span class="p">,</span><span class="n">yA</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;xA&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;yA&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1bce4da2abf7e4237b03265e0cec36d13d2802c12aac02b62552e1f6b4ac1873.png" src="../_images/1bce4da2abf7e4237b03265e0cec36d13d2802c12aac02b62552e1f6b4ac1873.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## And now P,x-y</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xA</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yA</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mole fraction of Acetonitrile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (bar)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;xA&#39;</span><span class="p">,</span> <span class="s1">&#39;yA&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2f9334298c30e8954f317fe859df107e60025eff45642101f1a3c7be70917825.png" src="../_images/2f9334298c30e8954f317fe859df107e60025eff45642101f1a3c7be70917825.png" />
</div>
</div>
</section>
</section>
</section>
<section id="lets-also-generate-a-t-xy-plot">
<h2>Let’s also generate a T-xy plot.<a class="headerlink" href="#lets-also-generate-a-t-xy-plot" title="Link to this heading">#</a></h2>
<p>Assume that we now have a constant pressure of 101.325 kPa = 1.01325 bar. This problem requires iterative solving.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Establishing new P</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">1.0325</span> <span class="c1"># bar</span>

<span class="c1">## Let&#39;s define a temperature range to iterative over:</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span> <span class="c1">#100 points ranging from 300 to 400 K. We can narrow this depending on our plot</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lets-define-a-function-that-will-help-us-solve-for-temperature-we-want-to-find-the-temperature-that-makes-the-xa-psata-xb-psatb-p-or-that-makes-p-xa-psata-xb-psatb-0">
<h2>Let’s define a function that will help us solve for temperature. We want to find the temperature that makes the xA*PsatA + xB*PsatB = P, or that makes P - (xA*PsatA + xB*PsatB) = 0.<a class="headerlink" href="#lets-define-a-function-that-will-help-us-solve-for-temperature-we-want-to-find-the-temperature-that-makes-the-xa-psata-xb-psatb-p-or-that-makes-p-xa-psata-xb-psatb-0" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">i</span><span class="p">):</span> <span class="c1">## this is a function. we pass in a temperature (T) and an array index (i)</span>
    <span class="n">PsatA</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_ace</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_ace</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_ace</span><span class="p">)))</span> <span class="c1">## saturated pressure using inputted T</span>
    <span class="n">PsatB</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_but</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_but</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_but</span><span class="p">)))</span>
    <span class="n">Ptest</span> <span class="o">=</span> <span class="n">xA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">PsatA</span> <span class="o">+</span> <span class="n">xB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">PsatB</span>
    <span class="n">yA</span> <span class="o">=</span> <span class="n">xA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">PsatA</span><span class="o">/</span><span class="n">P</span><span class="p">)</span> <span class="c1">## calculating vapor molar fraction of acetonitrile</span>
    <span class="n">yB</span> <span class="o">=</span> <span class="n">xB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">PsatB</span><span class="o">/</span><span class="n">P</span><span class="p">)</span> <span class="c1">## calculating vapor molar fraction of 1-butanol</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="n">Ptest</span><span class="p">)</span> <span class="c1">## is how we can easily find a minimum. we want this value to be as close to zero as possible!</span>
    <span class="k">return</span> <span class="n">diff</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="we-need-to-define-an-initial-guess-array-we-dont-know-what-the-temperature-might-be-so-we-might-make-a-guess-that-the-temperature-is-between-300-and-500c-we-choose-1000-increments-between-300-and-500-to-be-evaluated">
<h2>We need to define an initial guess array. We don’t know what the temperature might be, so we might make a guess that the temperature is between 300 and 500C. We choose 1000 increments between 300 and 500 to be evaluated<a class="headerlink" href="#we-need-to-define-an-initial-guess-array-we-dont-know-what-the-temperature-might-be-so-we-might-make-a-guess-that-the-temperature-is-between-300-and-500c-we-choose-1000-increments-between-300-and-500-to-be-evaluated" title="Link to this heading">#</a></h2>
<section id="note-1000-increments-is-arbitrary-one-can-choose-any-positive-integer">
<h3>Note: 1000 increments is arbitrary. One can choose any positive integer!<a class="headerlink" href="#note-1000-increments-is-arbitrary-one-can-choose-any-positive-integer" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lets-solve-for-our-temperatures">
<h2>Let’s solve for our temperatures!<a class="headerlink" href="#lets-solve-for-our-temperatures" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## define an empty array to store our iterative solution temperature values.</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xA</span><span class="p">)):</span> <span class="c1">## iterating over all the values in x1</span>
    <span class="n">min_diff</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">## we define a variable min_diff that &quot;resets&quot; our difference comparison</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Temp</span><span class="p">)):</span> <span class="c1">## iterating over all temperatures in Temp</span>
        <span class="n">diff_out</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">Temp</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">i</span><span class="p">)</span> <span class="c1">## using the function above to calculate the difference of pressures at a given temperature (j) and xA, xB (i)</span>
        <span class="k">if</span> <span class="n">diff_out</span> <span class="o">&lt;</span> <span class="n">min_diff</span><span class="p">:</span> <span class="c1">## if we reach a new minimum (less than the previous min_diff)</span>
            <span class="n">min_diff</span> <span class="o">=</span> <span class="n">diff_out</span> <span class="c1">## we establish whatever difference from the function output as the new min_diff</span>
            <span class="n">True_temp</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="c1">## this pulls out the temperature at that minimum</span>
    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">True_temp</span><span class="p">)</span> <span class="c1">## this adds the minimum difference temperature to our empty array of iterative temperature values</span>
    <span class="c1">#print(f&quot;Temperature: {True_temp},&quot;, f&quot;Difference: {min_diff}&quot;) ## this prints the &quot;True temperature&quot; and minimum difference for each x1, x2 combo</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="we-have-our-liquid-molar-fractions-and-temperatures-we-still-need-to-calculate-our-y1-and-y2-values-with-our-true-temperature">
<h2>We have our liquid molar fractions and temperatures. We still need to calculate our y1 and y2 values with our “true” temperature.<a class="headerlink" href="#we-have-our-liquid-molar-fractions-and-temperatures-we-still-need-to-calculate-our-y1-and-y2-values-with-our-true-temperature" title="Link to this heading">#</a></h2>
<section id="we-can-use-the-antoine-equation-and-raoults-law">
<h3>We can use the Antoine Equation and Raoult’s Law!<a class="headerlink" href="#we-can-use-the-antoine-equation-and-raoults-law" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">yB</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">##empty arrays to store the vapor mole fractions</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span>
    <span class="n">PsatA</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_ace</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_ace</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">C_ace</span><span class="p">)))</span> <span class="c1">## saturated pressure using true T</span>
    <span class="n">PsatB</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_but</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_but</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">C_but</span><span class="p">)))</span>
    <span class="n">yA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">PsatA</span><span class="o">/</span><span class="n">P</span><span class="p">))</span> <span class="c1">## calculating vapor molar fraction of acetonitrile and storing into yA</span>
    <span class="n">yB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">PsatB</span><span class="o">/</span><span class="n">P</span><span class="p">))</span> <span class="c1">## calculating vapor molar fraction of 1-butanol and storing into yB</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="now-lets-plot">
<h2>Now, let’s plot<a class="headerlink" href="#now-lets-plot" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xA</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yA</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot;-o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mole fraction of Acetonitrile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;xA&#39;</span><span class="p">,</span> <span class="s1">&#39;yA&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d289d4ca0c9ef96845b0354c5af2a94dbda92b2f9a1771243849451f50d01647.png" src="../_images/d289d4ca0c9ef96845b0354c5af2a94dbda92b2f9a1771243849451f50d01647.png" />
</div>
</div>
</section>
<section id="bubble-point">
<h2>Bubble Point<a class="headerlink" href="#bubble-point" title="Link to this heading">#</a></h2>
<p><strong>ADD IMAGE</strong></p>
<p>Recall that <span style="color:#DA7407"><strong>bubble point</strong></span> is the temperature or pressure where the first bubble of vapor forms when heating a mixture of two or more liquids.</p>
<section id="lets-calculate-the-bubble-point-temperature-if-we-werent-given-a-plot">
<h3>Let’s calculate the bubble point temperature if we weren’t given a plot.<a class="headerlink" href="#lets-calculate-the-bubble-point-temperature-if-we-werent-given-a-plot" title="Link to this heading">#</a></h3>
<p>Again, assume that we have a mixture of acetonitrile and 1-butanol and assume ideality for the mixture.</p>
<p>We want to calculate the bubble point temperature when the mixture is 25 mol% aceotnitrile and 75% 1-butanol at 1.01325 bar.</p>
<p>At the bubble point temperature, the first vapor bubble must be in equilibrium with the liquid phase (for which we know the composition), so the following relationships must be satisfied and the sum of mole fractions in each phase must be 1.</p>
<div class="math notranslate nohighlight">
\[x_iP_i^{vap}(T) = y_iP = P_i\]</div>
<div class="math notranslate nohighlight">
\[\sum{x_iP_i^{vap}(T)} = \sum{P_i} = P\]</div>
</section>
<section id="lets-first-re-establish-our-variables-we-are-resuing-ones-from-the-example-problems-above">
<h3>Let’s first (re)establish our variables. We are resuing ones from the example problems above.<a class="headerlink" href="#lets-first-re-establish-our-variables-we-are-resuing-ones-from-the-example-problems-above" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Liquid mole fractions</span>
<span class="n">xA</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">xB</span> <span class="o">=</span> <span class="mf">.75</span>

<span class="c1">##Antoine Coefficients</span>
<span class="c1">#Acetonitrile</span>
<span class="n">A_ace</span> <span class="o">=</span> <span class="mf">4.27873</span>
<span class="n">B_ace</span> <span class="o">=</span> <span class="mf">1355.374</span>
<span class="n">C_ace</span> <span class="o">=</span> <span class="o">-</span><span class="mf">37.853</span>
<span class="c1">#1-Butanol</span>
<span class="n">A_but</span> <span class="o">=</span> <span class="mf">4.54607</span>
<span class="n">B_but</span> <span class="o">=</span> <span class="mf">1351.55</span>
<span class="n">C_but</span> <span class="o">=</span> <span class="o">-</span><span class="mf">93.34</span>

<span class="n">P</span> <span class="o">=</span> <span class="mf">1.01325</span> <span class="c1">#bar</span>

<span class="c1">## Let&#39;s define a temperature range to iterate over</span>

<span class="n">Temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">## 300C to 500C over 1000 points</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="we-need-to-iterate-over-temperature-to-find-the-temperature-that-makes-the-sum-of-the-vapor-phase-mole-fractions-equal-to-one">
<h3>We need to iterate over temperature to find the temperature that makes the sum of the vapor phase mole fractions equal to one<a class="headerlink" href="#we-need-to-iterate-over-temperature-to-find-the-temperature-that-makes-the-sum-of-the-vapor-phase-mole-fractions-equal-to-one" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## creating a similar function to the iterative one above</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">T</span><span class="p">):</span> <span class="c1">## this is a function. we pass in a temperature (T)</span>
    <span class="n">PsatA</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_ace</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_ace</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_ace</span><span class="p">)))</span> <span class="c1">## saturated pressure using inputted T</span>
    <span class="n">PsatB</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_but</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_but</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_but</span><span class="p">)))</span>
    <span class="n">yA</span> <span class="o">=</span> <span class="n">xA</span><span class="o">*</span><span class="p">(</span><span class="n">PsatA</span><span class="o">/</span><span class="n">P</span><span class="p">)</span> <span class="c1">## calculating vapor molar fraction of acetonitrile</span>
    <span class="n">yB</span> <span class="o">=</span> <span class="n">xB</span><span class="o">*</span><span class="p">(</span><span class="n">PsatB</span><span class="o">/</span><span class="n">P</span><span class="p">)</span> <span class="c1">## calculating vapor molar fraction of 1-butanol</span>
    <span class="n">sumy</span> <span class="o">=</span> <span class="n">yA</span> <span class="o">+</span> <span class="n">yB</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sumy</span><span class="p">)</span> <span class="c1">## is how we can easily find a minimum. we want this value to be as close to zero as possible!</span>
    <span class="k">return</span> <span class="n">diff</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Let&#39;s solve!</span>

<span class="n">min_diff</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">## we define a variable min_diff that gives a comparison value</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Temp</span><span class="p">)):</span> <span class="c1">## iterating over all temperatures in Temp</span>
    <span class="n">diff_out</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">Temp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1">## using the function above to calculate the difference of (1-(y1+y2)) at a given temperature (j)</span>
    <span class="k">if</span> <span class="n">diff_out</span> <span class="o">&lt;</span> <span class="n">min_diff</span><span class="p">:</span> <span class="c1">## if we reach a new minimum (less than the previous min_diff)</span>
        <span class="n">min_diff</span> <span class="o">=</span> <span class="n">diff_out</span> <span class="c1">## we establish whatever difference from the function output as the new min_diff</span>
        <span class="n">True_temp</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">## this pulls out the temperature at that minimum</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">True_temp</span> <span class="c1">## there should only be one &quot;true&quot; temperature that satisfies yA + yB = 1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bubble Point Temperature&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bubble Point Temperature 379.48
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="dew-point">
<h2>Dew Point<a class="headerlink" href="#dew-point" title="Link to this heading">#</a></h2>
<p><strong>ADD IMAGE</strong></p>
<p>Recall that <span style="color:#DA7407"><strong>dew point</strong></span> is the temperature or pressure where the first drop of liquid forms when cooling a mixture of two or more vapors.</p>
<section id="lets-calculate-the-dew-point-temperature-if-we-werent-given-a-plot">
<h3>Let’s calculate the dew point temperature if we weren’t given a plot.<a class="headerlink" href="#lets-calculate-the-dew-point-temperature-if-we-werent-given-a-plot" title="Link to this heading">#</a></h3>
<p>Again, assume that we have a mixture of acetonitrile and 1-butanol and assume ideality for the mixture.</p>
<p>We want to calculate the dew point temperature when the mixture is 25 mol% aceotnitrile and 75% 1-butanol at 1.01325 bar.</p>
<p>At the dew point temperature, the first dew drop must be in equilibrium with the vapor phase (for which we know the composition), so the following relationships must be satisfied and the sum of mole fractions in each phase must be 1.</p>
<div class="math notranslate nohighlight">
\[x_iP_i^{vap}(T) = y_iP = P_i\]</div>
<div class="math notranslate nohighlight">
\[\sum{x_iP_i^{vap}(T)} = \sum{P_i} = P\]</div>
</section>
<section id="we-have-a-very-similar-problem-to-above-but-now-we-want-to-solve-for-x-a-x-b-1-since-we-know-our-vapor-mole-fractions">
<h3>We have a very similar problem to above, but now we want to solve for <span class="math notranslate nohighlight">\(x_A + x_B = 1\)</span> since we know our vapor mole fractions<a class="headerlink" href="#we-have-a-very-similar-problem-to-above-but-now-we-want-to-solve-for-x-a-x-b-1-since-we-know-our-vapor-mole-fractions" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Vapor mole fractions</span>

<span class="n">yA</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">yB</span> <span class="o">=</span> <span class="mf">.75</span>

<span class="c1">## Our Antoine coefficients and pressure are the same as before</span>

<span class="c1">## We will use the same temperature guesses</span>

<span class="n">Temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1">## 300C to 500C over 1000 points</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Creating a new function similar to above</span>

<span class="k">def</span> <span class="nf">k</span><span class="p">(</span><span class="n">T</span><span class="p">):</span> <span class="c1">## this is a function. we pass in a temperature (T)</span>
    <span class="n">PsatA</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_ace</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_ace</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_ace</span><span class="p">)))</span> <span class="c1">## saturated pressure using inputted T</span>
    <span class="n">PsatB</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_but</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_but</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_but</span><span class="p">)))</span>
    <span class="n">xA</span> <span class="o">=</span> <span class="n">yA</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">PsatA</span> <span class="c1">## calculating liquid molar fraction of acetonitrile</span>
    <span class="n">xB</span> <span class="o">=</span> <span class="n">yB</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">PsatB</span> <span class="c1">## calculating liquid molar fraction of 1-butanol</span>
    <span class="n">sumx</span> <span class="o">=</span> <span class="n">xA</span> <span class="o">+</span> <span class="n">xB</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sumx</span><span class="p">)</span> <span class="c1">## is how we can easily find a minimum. we want this value to be as close to zero as possible!</span>
    <span class="k">return</span> <span class="n">diff</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Solving!</span>

<span class="n">min_diff</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">## we define a variable min_diff that gives a comparison value</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Temp</span><span class="p">)):</span> <span class="c1">## iterating over all temperatures in Temp</span>
    <span class="n">diff_out</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">Temp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1">## using the function above to calculate the difference of (1-(xA+xB)) at a given temperature (j)</span>
    <span class="k">if</span> <span class="n">diff_out</span> <span class="o">&lt;</span> <span class="n">min_diff</span><span class="p">:</span> <span class="c1">## if we reach a new minimum (less than the previous min_diff)</span>
        <span class="n">min_diff</span> <span class="o">=</span> <span class="n">diff_out</span> <span class="c1">## we establish whatever difference from the function output as the new min_diff</span>
        <span class="n">True_temp</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">## this pulls out the temperature at that minimum</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">True_temp</span> <span class="c1">## there should only be one &quot;true&quot; temperature that satisfies yA + yB = 1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dew Point Temperature&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dew Point Temperature 386.09
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="non-ideality-is-more-often-the-reality">
<h2>Non-ideality is More Often the Reality<a class="headerlink" href="#non-ideality-is-more-often-the-reality" title="Link to this heading">#</a></h2>
<div class="math notranslate nohighlight">
\[\overline{f}_i^L(T,P,\underline{x}) = x_i\gamma_i(T,P,\underline{x})P_i^{vap}(T)\phi_i^{L,vap}(T,P) = \overline{f}_i^V(T,P,\underline{y}) = y_iP\overline{\phi}_i^V(T,P,\underline{y}) \]</div>
<p>Note that the activity coefficients are a function of temperature. Once we introduce them to account for non-ideality, we cannot write the pressure as a linear function of mole fractions and vapor pressures.</p>
<p>We have been treating the activity coefficient as though it were unity. For non-ideal systems, this is not the case and we need to calculate the activity coefficient.</p>
<section id="an-example">
<h3>An Example:<a class="headerlink" href="#an-example" title="Link to this heading">#</a></h3>
<p>We will do an example with a mixture of ethanol (E) and cyclohexane © at 303.15 K. We will create a P-x,y diagram.</p>
<p>We will assume that the activity coefficients are well-described by the <span style="color:#DA7407"><strong>van Laar</strong></span> equation. Table 5.1 has the parameters for this system, although the temperature ranges of the validity is higher than the temperature we are at.</p>
<div class="math notranslate nohighlight">
\[ ln(\gamma_1) = \frac{\alpha}{\left[1 + \frac{\alpha}{\beta}\frac{x_1}{x_2}\right]^2}\]</div>
<div class="math notranslate nohighlight">
\[ ln(\gamma_2) = \frac{\beta}{\left[1 + \frac{\beta}{\alpha}\frac{x_2}{x_1}\right]^2}\]</div>
<p>We will also assume that the vapor phase acts relatively ideal. We then have an equilibrium relationship as follows:</p>
<div class="math notranslate nohighlight">
\[P = x_E\gamma_EP_E^{vap} + x_C\gamma_CP_C^{vap}\]</div>
<div class="math notranslate nohighlight">
\[y_iP = x_i\gamma_iP_i^{vap}\]</div>
<p>We can replace each <span class="math notranslate nohighlight">\(\gamma_i\)</span> with its respective van Laar activity coefficient:</p>
<div class="math notranslate nohighlight">
\[P = x_Eexp\left(\frac{\alpha}{\left[1 + \frac{\alpha}{\beta}\frac{x_1}{x_2}\right]^2}\right)P_E^{vap} + x_Cexp\left(\frac{\beta}{\left[1 + \frac{\beta}{\alpha}\frac{x_2}{x_1}\right]^2}\right)P_C^{vap}\]</div>
<div class="math notranslate nohighlight">
\[y_E = \frac{x_Eexp\left(\frac{\alpha}{\left[1 + \frac{\alpha}{\beta}\frac{x_1}{x_2}\right]^2}\right)P_E^{vap}}{P}\]</div>
<p>Remember, we are at a fixed temperature so we can calculate <span class="math notranslate nohighlight">\(P^{vap}\)</span> using the Antoine Equation.</p>
<p><strong>INSERT MATH (DON’T HAVE BETA AND ALPHA VALUES)</strong></p>
<p><strong>INSERT COMPARISON PLOTS</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Making a P-x,y plot</span>

<span class="n">xE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">.9999</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">## hundred values of xE to calculate P</span>
<span class="c1">## NOTE: We can&#39;t have 0 and 1 inclusive because we will encounter a dividing by zero error</span>
<span class="n">xC</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xE</span> <span class="c1">## mole balance</span>

<span class="n">T</span> <span class="o">=</span> <span class="mf">303.15</span> <span class="c1"># K, our set temperature</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">## NEED THIS NUMBER</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">## NEED THIS NUMBER</span>

<span class="c1">## Antoine Coefficients</span>

<span class="n">A_eth</span> <span class="o">=</span> <span class="mf">4.92531</span>
<span class="n">B_eth</span> <span class="o">=</span> <span class="mf">1432.526</span>
<span class="n">C_eth</span> <span class="o">=</span> <span class="o">-</span><span class="mf">61.819</span>

<span class="n">A_cyc</span> <span class="o">=</span> <span class="mf">4.13983</span>
<span class="n">B_cyc</span> <span class="o">=</span> <span class="mf">1316.554</span>
<span class="n">C_cyc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">35.581</span>

<span class="c1">## Calculate Psat for ethanol and cyclohexane</span>

<span class="n">PsatE</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_eth</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_eth</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_eth</span><span class="p">)))</span>
<span class="n">PsatC</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">A_cyc</span> <span class="o">-</span> <span class="p">(</span><span class="n">B_cyc</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">C_cyc</span><span class="p">)))</span>

<span class="c1">## Calculate the gammas</span>

<span class="n">gammaE</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">gammaC</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xE</span><span class="p">)):</span>
    <span class="n">lngammaE</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">((</span><span class="n">alpha</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">xC</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">lngammaC</span> <span class="o">=</span> <span class="n">beta</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">((</span><span class="n">beta</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">xE</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">gammaE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lngammaE</span><span class="p">))</span>
    <span class="n">gammaC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lngammaC</span><span class="p">))</span>

<span class="c1">## Calculate pressure and vapor mole fraction</span>

<span class="n">P</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## empty array to store all the pressure values</span>
<span class="n">yE</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## empty array to store all ethanol vapor values</span>
<span class="n">yC</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">## empty array to store all cyclohexane vapor values</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xE</span><span class="p">)):</span> <span class="c1">## iterating over all our liquid mole fractions</span>
    <span class="n">P_calc</span> <span class="o">=</span> <span class="n">xE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gammaE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">PsatE</span> <span class="o">+</span> <span class="n">xC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gammaC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">PsatC</span>
    <span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P_calc</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xE</span><span class="p">)):</span> <span class="c1">## iterating over all liquid mole fractions</span>
    <span class="n">yE_calc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gammaE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">PsatE</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">## remember, pressure is an array too!</span>
    <span class="n">yE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yE_calc</span><span class="p">)</span>
    <span class="n">yC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">yE_calc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we can plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xE</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yE</span><span class="p">,</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;xE&#39;</span><span class="p">,</span><span class="s1">&#39;yE&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mole fraction ethanol&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (kPa)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/638e237f6647fd7439f24c6c3e52f513da07ab9a0c0d7797442ff797b3909160.png" src="../_images/638e237f6647fd7439f24c6c3e52f513da07ab9a0c0d7797442ff797b3909160.png" />
</div>
</div>
<p><strong>COMPARING RESULTS</strong> PUT IN FIGURES ETC</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Ch8"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-to-something-workable">Getting To Something Workable:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-do-an-example">Let’s Do an Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-x-y-and-p-x-y-charts-for-acetonitrile-and-1-butanol-at-t-333-15-k-assume-the-mixture-is-ideal">Create x,y and P-x,y charts for acetonitrile and 1-butanol at T = 333.15 K. Assume the mixture is ideal.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-vapor-pressures">Solving for Vapor Pressures</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-phase-mole-fractions">Calculating Phase Mole Fractions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-remaining-variables-p-y-a-y-b">Solving For the Remaining Variables (P, <span class="math notranslate nohighlight">\(y_A\)</span>, <span class="math notranslate nohighlight">\(y_B\)</span>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-all-the-information-we-need-to-generate-x-y-and-p-x-y-charts">We have all the information we need to generate x,y and P-x,y charts!</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-also-generate-a-t-xy-plot">Let’s also generate a T-xy plot.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-define-a-function-that-will-help-us-solve-for-temperature-we-want-to-find-the-temperature-that-makes-the-xa-psata-xb-psatb-p-or-that-makes-p-xa-psata-xb-psatb-0">Let’s define a function that will help us solve for temperature. We want to find the temperature that makes the xA*PsatA + xB*PsatB = P, or that makes P - (xA*PsatA + xB*PsatB) = 0.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-need-to-define-an-initial-guess-array-we-dont-know-what-the-temperature-might-be-so-we-might-make-a-guess-that-the-temperature-is-between-300-and-500c-we-choose-1000-increments-between-300-and-500-to-be-evaluated">We need to define an initial guess array. We don’t know what the temperature might be, so we might make a guess that the temperature is between 300 and 500C. We choose 1000 increments between 300 and 500 to be evaluated</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-1000-increments-is-arbitrary-one-can-choose-any-positive-integer">Note: 1000 increments is arbitrary. One can choose any positive integer!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-solve-for-our-temperatures">Let’s solve for our temperatures!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-our-liquid-molar-fractions-and-temperatures-we-still-need-to-calculate-our-y1-and-y2-values-with-our-true-temperature">We have our liquid molar fractions and temperatures. We still need to calculate our y1 and y2 values with our “true” temperature.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-use-the-antoine-equation-and-raoults-law">We can use the Antoine Equation and Raoult’s Law!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-lets-plot">Now, let’s plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bubble-point">Bubble Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-calculate-the-bubble-point-temperature-if-we-werent-given-a-plot">Let’s calculate the bubble point temperature if we weren’t given a plot.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-first-re-establish-our-variables-we-are-resuing-ones-from-the-example-problems-above">Let’s first (re)establish our variables. We are resuing ones from the example problems above.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-need-to-iterate-over-temperature-to-find-the-temperature-that-makes-the-sum-of-the-vapor-phase-mole-fractions-equal-to-one">We need to iterate over temperature to find the temperature that makes the sum of the vapor phase mole fractions equal to one</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dew-point">Dew Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lets-calculate-the-dew-point-temperature-if-we-werent-given-a-plot">Let’s calculate the dew point temperature if we weren’t given a plot.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-a-very-similar-problem-to-above-but-now-we-want-to-solve-for-x-a-x-b-1-since-we-know-our-vapor-mole-fractions">We have a very similar problem to above, but now we want to solve for <span class="math notranslate nohighlight">\(x_A + x_B = 1\)</span> since we know our vapor mole fractions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-ideality-is-more-often-the-reality">Non-ideality is More Often the Reality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-example">An Example:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By J. J. Richards
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>